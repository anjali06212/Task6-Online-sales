-- Create the orders table
CREATE TABLE IF NOT EXISTS orders (
    product_id VARCHAR(50),
    order_date DATE,
    amount DECIMAL(10, 2)
);

-- Insert sample data (48 records, 2 per month for 2023-2024)
INSERT INTO orders (product_id, order_date, amount) VALUES
('1001', '2023-01-01', 450.25),
('1002', '2023-01-15', 320.50),
('1003', '2023-02-01', 390.00),
('1004', '2023-02-15', 275.25),
('1005', '2023-03-01', 510.80),
('1006', '2023-03-15', 420.40),
('1007', '2023-04-01', 380.75),
('1008', '2023-04-15', 295.60),
('1009', '2023-05-01', 430.20),
('1010', '2023-05-15', 360.80),
('1011', '2023-06-01', 475.50),
('1012', '2023-06-15', 310.25),
('1013', '2023-07-01', 520.00),
('1014', '2023-07-15', 390.75),
('1015', '2023-08-01', 410.30),
('1016', '2023-08-15', 330.50),
('1017', '2023-09-01', 450.25),
('1018', '2023-09-15', 380.00),
('1019', '2023-10-01', 490.60),
('1020', '2023-10-15', 420.25),
('1021', '2023-11-01', 550.80),
('1022', '2023-11-15', 480.50),
('1023', '2023-12-01', 600.00),
('1024', '2023-12-15', 520.75),
('1025', '2024-01-01', 460.25),
('1026', '2024-01-15', 340.50),
('1027', '2024-02-01', 400.00),
('1028', '2024-02-15', 285.25),
('1029', '2024-03-01', 530.80),
('1030', '2024-03-15', 440.40),
('1031', '2024-04-01', 390.75),
('1032', '2024-04-15', 305.60),
('1033', '2024-05-01', 450.20),
('1034', '2024-05-15', 370.80),
('1035', '2024-06-01', 485.50),
('1036', '2024-06-15', 320.25),
('1037', '2024-07-01', 540.00),
('1038', '2024-07-15', 400.75),
('1039', '2024-08-01', 420.30),
('1040', '2024-08-15', 340.50),
('1041', '2024-09-01', 460.25),
('1042', '2024-09-15', 390.00),
('1043', '2024-10-01', 500.60),
('1044', '2024-10-15', 430.25),
('1045', '2024-11-01', 570.80),
('1046', '2024-11-15', 490.50),
('1047', '2024-12-01', 600.00),
('1048', '2024-12-15', 750.50);

-- Analysis query for monthly revenue and order volume
SELECT 
    EXTRACT(YEAR FROM order_date) AS year,
    EXTRACT(MONTH FROM order_date) AS month,
    TO_CHAR(order_date, 'Month') AS month_name,
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT product_id) AS order_volume
FROM orders
WHERE order_date >= '2023-01-01' AND order_date < '2025-01-01'
GROUP BY 
    EXTRACT(YEAR FROM order_date),
    EXTRACT(MONTH FROM order_date),
    TO_CHAR(order_date, 'Month')
ORDER BY 
    year, 
    month
LIMIT 24;